kind: pipeline
type: docker 
name: default

steps:
 
  
  #- name: install-dependencies
   # image: node
    #commands:
     # - npm install

  - name: tests
    image: node
    commands:
      - npm run test

  - name: build test image
    image: plugins/docker
    volumes:
      - name: docker_sock
        path: /var/run/docker.sock
    commands:
      - echo ${DRONE_COMMIT} 
  - name: slack
    image: plugins/slack
    settings:
      webhook: 
        from_secret: slack-hook
      channel: dev-status
      template: >
        {{#success build.status}}
          Build {{build.number}} on ${DRONE_BRANCH} succeeded ðŸš€

          **Commit**: ${DRONE_COMMIT_MESSAGE}  - ${DRONE_COMMIT_AUTHOR}
          ${DRONE_COMMIT_LINK}
          
          Good job ðŸ’ª.
        {{else}}
          Build {{build.number}} on ${DRONE_BRANCH} failed ðŸ˜± 
          **Commit**: ${DRONE_COMMIT_MESSAGE}  - ${DRONE_COMMIT_AUTHOR}
          ${DRONE_COMMIT_LINK} 

          Following steps have failed: ${DRONE_FAILED_STAGES}
          
          Fix me please ðŸ’‰.
        {{/success}}
